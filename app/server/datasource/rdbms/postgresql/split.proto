syntax = "proto3";

import "google/protobuf/wrappers.proto";

package NYql.Connector.App.Server.DataSource.RDBMS.PostgreSQL;

option go_package = "github.com/ydb-platform/fq-connector-go/app/server/datasource/rdbms/postgresql/";

// TInt32Bounds represents the bounds that can be found for an `int`, `serial`, `int4` column
// An open interval can be represented by omitting one of the bounds.
message TInt32Bounds {
    google.protobuf.Int32Value upper = 1;
    google.protobuf.Int32Value lower = 2;
};

// TInt64Bounds represents the bounds that can be found for an `bigint`, `bigserial`, `int8` column
// An open interval can be represented by omitting one of the bounds.
message TInt64Bounds {
    google.protobuf.Int64Value upper = 1;
    google.protobuf.Int64Value lower = 2;
};

// TDecimalBounds represents the bounds that can be found for a `numeric`, `decimal` column
// An open interval can be represented by omitting one of the bounds.
message TDecimalBounds {
    google.protobuf.StringValue upper = 1;
    google.protobuf.StringValue lower = 2;
};

// TSplitDescription represents the description of PostgreSQL's table split.
message TSplitDescription {
    // TSingle means that table will be read sequentially
    message TSingle {
    }

    // THistogramBounds describes the method of large table splitting.
    // based on the PostgreSQL's internal table stats.
    message THistogramBounds {
        string column_name = 1;

        oneof payload {
            TInt32Bounds int32_bounds = 3;
            TInt64Bounds int64_bounds = 2;
            TDecimalBounds decimal_bounds = 4;
        }
    }

    oneof payload {
        TSingle single = 1;
        THistogramBounds histogram_bounds = 2;
    }
}
